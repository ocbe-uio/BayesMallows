<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given a consistent set of pairwise preferences, generate a complete ranking
of items which is consistent with the preferences."><title>Generate Initial Ranking — generate_initial_ranking • BayesMallows</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Initial Ranking — generate_initial_ranking"><meta property="og:description" content="Given a consistent set of pairwise preferences, generate a complete ranking
of items which is consistent with the preferences."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BayesMallows</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/BayesMallows.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SMC-Mallows.html">Sequential Inference with the Mallows Model</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ocbe-uio/BayesMallows/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generate Initial Ranking</h1>
      <small class="dont-index">Source: <a href="https://github.com/ocbe-uio/BayesMallows/blob/HEAD/R/generate_initial_ranking.R" class="external-link"><code>R/generate_initial_ranking.R</code></a></small>
      <div class="d-none name"><code>generate_initial_ranking.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a consistent set of pairwise preferences, generate a complete ranking
of items which is consistent with the preferences.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_initial_ranking</span><span class="op">(</span></span>
<span>  <span class="va">tc</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">tc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bottom_item"</span>, <span class="st">"top_item"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shuffle_unranked <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random_limit <span class="op">=</span> <span class="fl">8L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tc</dt>
<dd><p>A dataframe with pairwise comparisons of <code>S3</code> subclass
<code>BayesMallowsTC</code>, returned from
<code><a href="generate_transitive_closure.html">generate_transitive_closure</a></code>.</p></dd>


<dt>n_items</dt>
<dd><p>The total number of items. If not provided, it is assumed to
equal the largest item index found in <code>tc</code>, i.e., <code>max(tc[,
c("bottom_item", "top_item")])</code>.</p></dd>


<dt>cl</dt>
<dd><p>Optional computing cluster used for parallelization, returned from
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster</a></code>. Defaults to <code>NULL</code>.</p></dd>


<dt>shuffle_unranked</dt>
<dd><p>Logical specifying whether or not to randomly
permuted unranked items in the initial ranking. When
<code>shuffle_unranked=TRUE</code> and <code>random=FALSE</code>, all unranked items
for each assessor are randomly permuted. Otherwise, the first ordering
returned by <code><a href="https://r.igraph.org/reference/topo_sort.html" class="external-link">igraph::topo_sort()</a></code> is returned.</p></dd>


<dt>random</dt>
<dd><p>Logical specifying whether or not to use a random initial
ranking. Defaults to <code>FALSE</code>. Setting this to <code>TRUE</code> means that
all possible orderings consistent with the stated pairwise preferences are
generated for each assessor, and one of them is picked at random.</p></dd>


<dt>random_limit</dt>
<dd><p>Integer specifying the maximum number of items allowed
when all possible orderings are computed, i.e., when <code>random=TRUE</code>.
Defaults to <code>8L</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix of rankings which can be given in the <code>rankings</code></p>


<p>argument to <code><a href="compute_mallows.html">compute_mallows</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Setting <code>random=TRUE</code> means that all possible orderings of each
  assessor's preferences are generated, and one of them is picked at random.
  This can be useful when experiencing convergence issues, e.g., if the MCMC
  algorithm does not mixed properly. However, finding all possible orderings
  is a combinatorial problem, which may be computationally very hard. The
  result may not even be possible to fit in memory, which may cause the R
  session to crash. When using this option, please try to increase the size
  of the problem incrementally, by starting with smaller subsets of the
  complete data. An example is given below.</p>
<p>As detailed in the documentation to <code><a href="generate_transitive_closure.html">generate_transitive_closure</a></code>,
  it is assumed that the items are labeled starting from 1. For example, if a single
  comparison of the following form is provided, it is assumed that there is a total
  of 30 items (<code>n_items=30</code>), and the initial ranking is a permutation of these 30
  items consistent with the preference 29&lt;30.</p>
<table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>29</td><td>30</td></tr></table><p>If in reality there are only two items, they should be relabeled to 1 and 2, as follows:</p>
<table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>1</td><td>2</td></tr></table></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other preprocessing: 
<code><a href="estimate_partition_function.html">estimate_partition_function</a>()</code>,
<code><a href="generate_constraints.html">generate_constraints</a>()</code>,
<code><a href="generate_transitive_closure.html">generate_transitive_closure</a>()</code>,
<code><a href="obs_freq.html">obs_freq</a></code>,
<code><a href="prepare_partition_function.html">prepare_partition_function</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The example dataset beach_preferences contains pairwise preferences of beach.</span></span></span>
<span class="r-in"><span><span class="co"># We must first generate the transitive closure</span></span></span>
<span class="r-in"><span><span class="va">beach_tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_transitive_closure.html">generate_transitive_closure</a></span><span class="op">(</span><span class="va">beach_preferences</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Next, we generate an initial ranking</span></span></span>
<span class="r-in"><span><span class="va">beach_init</span> <span class="op">&lt;-</span> <span class="fu">generate_initial_ranking</span><span class="op">(</span><span class="va">beach_tc</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at the first few rows:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">beach_init</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7   15    3   14   13    2   10   12    6     4     1     5     8    11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    5   15   14    6    2   13   12   11    1     7     4    10     9     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    3    9    7   15   14    2    6   13    1     8    12    11    10     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    5   15    2   14   11    8    9   10    1     4     3    13     7    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    9   15    7    5    6    1   14   13    4     3     2    12    11     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    9   13    5   12   15    3    7   11    1     6     4    14     8    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can add more informative column names in order</span></span></span>
<span class="r-in"><span><span class="co"># to get nicer posterior plots:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">beach_init</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Beach"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">beach_init</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">beach_init</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Beach 1 Beach 2 Beach 3 Beach 4 Beach 5 Beach 6 Beach 7 Beach 8 Beach 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       7      15       3      14      13       2      10      12       6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       5      15      14       6       2      13      12      11       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       3       9       7      15      14       2       6      13       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       5      15       2      14      11       8       9      10       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       9      15       7       5       6       1      14      13       4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       9      13       5      12      15       3       7      11       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Beach 10 Beach 11 Beach 12 Beach 13 Beach 14 Beach 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        4        1        5        8       11        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        7        4       10        9        8        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        8       12       11       10        5        4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        4        3       13        7       12        6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        3        2       12       11        8       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        6        4       14        8       10        2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># By default, the algorithm for generating the initial ranking is deterministic.</span></span></span>
<span class="r-in"><span><span class="co"># It is possible to randomly permute the unranked items with the argument shuffle_unranked,</span></span></span>
<span class="r-in"><span><span class="co"># as demonstrated below. This algorithm is computationally efficient, but defaults to FALSE</span></span></span>
<span class="r-in"><span><span class="co"># for backward compatibility.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2233</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beach_init</span> <span class="op">&lt;-</span> <span class="fu">generate_initial_ranking</span><span class="op">(</span><span class="va">beach_tc</span>, shuffle_unranked <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">beach_init</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    7   15    3   14   13    2   10   12    6     4     1     5     8    11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    6   15    3    7    2   13   14   12    1     8     5    11     9    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    4   10    8   15   14    3    7   13    2     9    12    11     1     6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    5   15    2   12   11    8    9   10    1     4     3    14     7    13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    9   12    7    5    6    1   15   14    4     3     2    13    11     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    9   13    5   12   15    3    7   11    1     6     4    14     8    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It is also possible to pick a random sample among all topological sorts.</span></span></span>
<span class="r-in"><span><span class="co"># This requires first enumerating all possible sorts, and might hence be computationally</span></span></span>
<span class="r-in"><span><span class="co"># demanding. Here is an example, where we reduce the data considerable to speed up computation.</span></span></span>
<span class="r-in"><span><span class="va">small_tc</span> <span class="op">&lt;-</span> <span class="va">beach_tc</span><span class="op">[</span><span class="va">beach_tc</span><span class="op">$</span><span class="va">assessor</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>                       <span class="va">beach_tc</span><span class="op">$</span><span class="va">bottom_item</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span> <span class="op">&amp;</span> <span class="va">beach_tc</span><span class="op">$</span><span class="va">top_item</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">init_small</span> <span class="op">&lt;-</span> <span class="fu">generate_initial_ranking</span><span class="op">(</span>tc <span class="op">=</span> <span class="va">small_tc</span>, n_items <span class="op">=</span> <span class="fl">4</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Look at the initial rankings generated</span></span></span>
<span class="r-in"><span><span class="va">init_small</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    3    1    4    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1    4    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    1    3    2    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    1    4    3    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4    2    3    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    3    1    4    2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For this small dataset, we can also study the effect of setting shuffle_unranked=TRUE</span></span></span>
<span class="r-in"><span><span class="co"># in more detail. We consider assessors 1 and 2 only.</span></span></span>
<span class="r-in"><span><span class="co"># First is the deterministic ordering. This one is equal for each run.</span></span></span>
<span class="r-in"><span><span class="fu">generate_initial_ranking</span><span class="op">(</span>tc <span class="op">=</span> <span class="va">small_tc</span><span class="op">[</span><span class="va">small_tc</span><span class="op">$</span><span class="va">assessor</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>                         n_items <span class="op">=</span> <span class="fl">4</span>, shuffle_unranked <span class="op">=</span> <span class="cn">FALSE</span>, random <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2    4    1    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1    4    3    2</span>
<span class="r-in"><span><span class="co"># Next we shuffle the unranked, setting the seed for reproducibility.</span></span></span>
<span class="r-in"><span><span class="co"># For assessor 1, item 2 is unranked, and by rerunning the code multiple times,</span></span></span>
<span class="r-in"><span><span class="co"># we see that element (1, 2) indeed changes ranking randomly.</span></span></span>
<span class="r-in"><span><span class="co"># For assessor 2, item 3 is unranked, and we can also see that this item changes</span></span></span>
<span class="r-in"><span><span class="co"># ranking randomly when rerunning the function multiple times.</span></span></span>
<span class="r-in"><span><span class="co"># The ranked items also change their ranking from one random realiziation to another,</span></span></span>
<span class="r-in"><span><span class="co"># but their relative ordering is constant.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">generate_initial_ranking</span><span class="op">(</span>tc <span class="op">=</span> <span class="va">small_tc</span><span class="op">[</span><span class="va">small_tc</span><span class="op">$</span><span class="va">assessor</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>                         n_items <span class="op">=</span> <span class="fl">4</span>, shuffle_unranked <span class="op">=</span> <span class="cn">TRUE</span>, random <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [,1] [,2] [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    2    3    1    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1    3    4    2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># We now give beach_init and beach_tc to compute_mallows. We tell compute_mallows</span></span></span>
<span class="r-in"><span>  <span class="co"># to save the augmented data, in order to study the convergence.</span></span></span>
<span class="r-in"><span>  <span class="va">model_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="compute_mallows.html">compute_mallows</a></span><span class="op">(</span>rankings <span class="op">=</span> <span class="va">beach_init</span>,</span></span>
<span class="r-in"><span>                               preferences <span class="op">=</span> <span class="va">beach_tc</span>,</span></span>
<span class="r-in"><span>                               nmc <span class="op">=</span> <span class="fl">2000</span>,</span></span>
<span class="r-in"><span>                               save_aug <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can study the acceptance rate of the augmented rankings</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="assess_convergence.html">assess_convergence</a></span><span class="op">(</span><span class="va">model_fit</span>, parameter <span class="op">=</span> <span class="st">"Rtilde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># We can also study the posterior distribution of the consensus rank of each beach</span></span></span>
<span class="r-in"><span>  <span class="va">model_fit</span><span class="op">$</span><span class="va">burnin</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_fit</span>, parameter <span class="op">=</span> <span class="st">"rho"</span>, items <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># The computations can also be done in parallel</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">beach_tc</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_transitive_closure.html">generate_transitive_closure</a></span><span class="op">(</span><span class="va">beach_preferences</span>, cl <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">beach_init</span> <span class="op">&lt;-</span> <span class="fu">generate_initial_ranking</span><span class="op">(</span><span class="va">beach_tc</span>, cl <span class="op">=</span> <span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Oystein Sorensen, Valeria Vitelli, Marta Crispino, Qinghua Liu, Cristina Mollica, Luca Tardella, Anja Stein.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

