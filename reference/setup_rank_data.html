<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Prepare rank or preference data for further analyses."><title>Setup rank data — setup_rank_data • BayesMallows</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setup rank data — setup_rank_data"><meta property="og:description" content="Prepare rank or preference data for further analyses."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BayesMallows</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/BayesMallows.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SMC-Mallows.html">Sequential Monte Carlo for the Bayesian Mallows model</a>
    <a class="dropdown-item" href="../articles/parallel_chains.html">MCMC with Parallel Chains</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ocbe-uio/BayesMallows/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Setup rank data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ocbe-uio/BayesMallows/blob/HEAD/R/setup_rank_data.R" class="external-link"><code>R/setup_rank_data.R</code></a></small>
      <div class="d-none name"><code>setup_rank_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Prepare rank or preference data for further analyses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setup_rank_data</span><span class="op">(</span></span>
<span>  rankings <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preferences <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  user_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  observation_frequency <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  validate_rankings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  na_action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"augment"</span>, <span class="st">"fail"</span>, <span class="st">"omit"</span><span class="op">)</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  shuffle_unranked <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random_limit <span class="op">=</span> <span class="fl">8L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>rankings</dt>
<dd><p>A matrix of ranked items, of size <code>n_assessors x n_items</code>. A
matrix of zero rows is allowed, and in this case samples from the prior
distribution are returned. See <code><a href="create_ranking.html">create_ranking()</a></code> if you have an ordered
set of items that need to be converted to rankings. If <code>preferences</code> is
provided, <code>rankings</code> is an optional initial value of the rankings. If
<code>rankings</code> has column names, these are assumed to be the names of the
items. <code>NA</code> values in rankings are treated as missing data and
automatically augmented; to change this behavior, see the <code>na_action</code>
argument to <code><a href="set_model_options.html">set_model_options()</a></code>.</p></dd>


<dt>preferences</dt>
<dd><p>A data frame with one row per pairwise comparison, and
columns <code>assessor</code>, <code>top_item</code>, and <code>bottom_item</code>. Each column contains the
following:</p><ul><li><p><code>assessor</code> is a numeric vector containing the assessor index.</p></li>
<li><p><code>bottom_item</code> is a numeric vector containing the index of the item that
was disfavored in each pairwise comparison.</p></li>
<li><p><code>top_item</code> is a numeric vector containing the index of the item that was
preferred in each pairwise comparison.</p></li>
</ul><p>So if we have two assessors and five items, and assessor 1 prefers item 1
to item 2 and item 1 to item 5, while assessor 2 prefers item 3 to item 5,
we have the following <code>df</code>:</p><table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>2</td><td>1</td></tr><tr><td>1</td><td>5</td><td>1</td></tr><tr><td>2</td><td>5</td><td>3</td></tr></table></dd>


<dt>user_ids</dt>
<dd><p>Optional vector of user IDs. Defaults to <code>NULL</code>, and only
used by <code><a href="update_mallows.html">update_mallows()</a></code>. If provided, new data can consist of updated
partial rankings from users already in the dataset, as described in Section
6 of
Stein (2023)
.</p></dd>


<dt>observation_frequency</dt>
<dd><p>A vector of observation frequencies (weights) to
apply do each row in <code>rankings</code>. This can speed up computation if a large
number of assessors share the same rank pattern. Defaults to <code>NULL</code>, which
means that each row of <code>rankings</code> is multiplied by 1. If provided,
<code>observation_frequency</code> must have the same number of elements as there are
rows in <code>rankings</code>, and <code>rankings</code> cannot be <code>NULL</code>. See
<code><a href="compute_observation_frequency.html">compute_observation_frequency()</a></code> for a convenience function for computing
it.</p></dd>


<dt>validate_rankings</dt>
<dd><p>Logical specifying whether the rankings provided (or
generated from <code>preferences</code>) should be validated. Defaults to <code>TRUE</code>.
Turning off this check will reduce computing time with a large number of
items or assessors.</p></dd>


<dt>na_action</dt>
<dd><p>Character specifying how to deal with <code>NA</code> values in the
<code>rankings</code> matrix, if provided. Defaults to <code>"augment"</code>, which means that
missing values are automatically filled in using the Bayesian data
augmentation scheme described in
Vitelli et al. (2018)
. The other options for this
argument are <code>"fail"</code>, which means that an error message is printed and the
algorithm stops if there are <code>NA</code>s in <code>rankings</code>, and <code>"omit"</code> which simply
deletes rows with <code>NA</code>s in them.</p></dd>


<dt>cl</dt>
<dd><p>Optional computing cluster used for parallelization when generating
transitive closure based on preferences, returned from
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code>. Defaults to <code>NULL</code>.</p></dd>


<dt>shuffle_unranked</dt>
<dd><p>Logical specifying whether or not to randomly permute
unranked items in the initial ranking. When <code>shuffle_unranked=TRUE</code> and
<code>random=FALSE</code>, all unranked items for each assessor are randomly permuted.
Otherwise, the first ordering returned by <code><a href="https://r.igraph.org/reference/topo_sort.html" class="external-link">igraph::topo_sort()</a></code> is
returned.</p></dd>


<dt>random</dt>
<dd><p>Logical specifying whether or not to use a random initial
ranking. Defaults to <code>FALSE</code>. Setting this to <code>TRUE</code> means that all
possible orderings consistent with the stated pairwise preferences are
generated for each assessor, and one of them is picked at random.</p></dd>


<dt>random_limit</dt>
<dd><p>Integer specifying the maximum number of items allowed
when all possible orderings are computed, i.e., when <code>random=TRUE</code>.
Defaults to <code>8L</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>"BayesMallowsData"</code>, to be provided in the <code>data</code></p>


<p>argument to <code><a href="compute_mallows.html">compute_mallows()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Setting <code>random=TRUE</code> means that all possible orderings of each
assessor's preferences are generated, and one of them is picked at random.
This can be useful when experiencing convergence issues, e.g., if the MCMC
algorithm does not mix properly. However, finding all possible orderings is
a combinatorial problem, which may be computationally very hard. The result
may not even be possible to fit in memory, which may cause the R session to
crash. When using this option, please try to increase the size of the
problem incrementally, by starting with smaller subsets of the complete
data. An example is given below.</p>
<p>It is assumed that the items are labeled starting from 1. For example, if a
single comparison of the following form is provided, it is assumed that
there is a total of 30 items (<code>n_items=30</code>), and the initial ranking is a
permutation of these 30 items consistent with the preference 29&lt;30.</p>
<table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>29</td><td>30</td></tr></table><p>If in reality there are only two items, they should be relabeled to 1 and
2, as follows:</p>
<table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>1</td><td>2</td></tr></table></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other preprocessing: 
<code><a href="get_transitive_closure.html">get_transitive_closure</a>()</code>,
<code><a href="set_compute_options.html">set_compute_options</a>()</code>,
<code><a href="set_initial_values.html">set_initial_values</a>()</code>,
<code><a href="set_model_options.html">set_model_options</a>()</code>,
<code><a href="set_priors.html">set_priors</a>()</code>,
<code><a href="set_smc_options.html">set_smc_options</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Oystein Sorensen, Waldir Leoncio, Valeria Vitelli, Marta Crispino, Qinghua Liu, Cristina Mollica, Luca Tardella, Anja Stein.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

