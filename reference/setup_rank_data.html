<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Setup rank data — setup_rank_data • BayesMallows</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setup rank data — setup_rank_data"><meta name="description" content="Prepare rank or preference data for further analyses."><meta property="og:description" content="Prepare rank or preference data for further analyses."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesMallows</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/BayesMallows.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/parallel_chains.html">MCMC with Parallel Chains</a></li>
    <li><a class="dropdown-item" href="../articles/SMC-Mallows.html">Sequential Monte Carlo for the Bayesian Mallows model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ocbe-uio/BayesMallows/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Setup rank data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ocbe-uio/BayesMallows/blob/v2.2.4/R/setup_rank_data.R" class="external-link"><code>R/setup_rank_data.R</code></a></small>
      <div class="d-none name"><code>setup_rank_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Prepare rank or preference data for further analyses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setup_rank_data</span><span class="op">(</span></span>
<span>  rankings <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preferences <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  user_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  observation_frequency <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  validate_rankings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  na_action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"augment"</span>, <span class="st">"fail"</span>, <span class="st">"omit"</span><span class="op">)</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_topological_sorts <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  timepoint <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_items <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-rankings">rankings<a class="anchor" aria-label="anchor" href="#arg-rankings"></a></dt>
<dd><p>A matrix of ranked items, of size <code>n_assessors x n_items</code>.
See <code><a href="create_ranking.html">create_ranking()</a></code> if you have an ordered set of items that need to be
converted to rankings. If <code>preferences</code> is provided, <code>rankings</code> is an
optional initial value of the rankings. If <code>rankings</code> has column names,
these are assumed to be the names of the items. <code>NA</code> values in rankings are
treated as missing data and automatically augmented; to change this
behavior, see the <code>na_action</code> argument to <code><a href="set_model_options.html">set_model_options()</a></code>. A vector
length <code>n_items</code> is silently converted to a matrix of length <code>1 x n_items</code>,
and names (if any), are used as column names.</p></dd>


<dt id="arg-preferences">preferences<a class="anchor" aria-label="anchor" href="#arg-preferences"></a></dt>
<dd><p>A data frame with one row per pairwise comparison, and
columns <code>assessor</code>, <code>top_item</code>, and <code>bottom_item</code>. Each column contains the
following:</p><ul><li><p><code>assessor</code> is a numeric vector containing the assessor index.</p></li>
<li><p><code>bottom_item</code> is a numeric vector containing the index of the item that
was disfavored in each pairwise comparison.</p></li>
<li><p><code>top_item</code> is a numeric vector containing the index of the item that was
preferred in each pairwise comparison.</p></li>
</ul><p>So if we have two assessors and five items, and assessor 1 prefers item 1
to item 2 and item 1 to item 5, while assessor 2 prefers item 3 to item 5,
we have the following <code>df</code>:</p><table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>2</td><td>1</td></tr><tr><td>1</td><td>5</td><td>1</td></tr><tr><td>2</td><td>5</td><td>3</td></tr></table></dd>


<dt id="arg-user-ids">user_ids<a class="anchor" aria-label="anchor" href="#arg-user-ids"></a></dt>
<dd><p>Optional <code>numeric</code> vector of user IDs. Only only used by
<code><a href="update_mallows.html">update_mallows()</a></code>. If provided, new data can consist of updated partial
rankings from users already in the dataset, as described in Section 6 of
Stein (2023)
.</p></dd>


<dt id="arg-observation-frequency">observation_frequency<a class="anchor" aria-label="anchor" href="#arg-observation-frequency"></a></dt>
<dd><p>A vector of observation frequencies (weights) to
apply do each row in <code>rankings</code>. This can speed up computation if a large
number of assessors share the same rank pattern. Defaults to <code>NULL</code>, which
means that each row of <code>rankings</code> is multiplied by 1. If provided,
<code>observation_frequency</code> must have the same number of elements as there are
rows in <code>rankings</code>, and <code>rankings</code> cannot be <code>NULL</code>. See
<code><a href="compute_observation_frequency.html">compute_observation_frequency()</a></code> for a convenience function for computing
it.</p></dd>


<dt id="arg-validate-rankings">validate_rankings<a class="anchor" aria-label="anchor" href="#arg-validate-rankings"></a></dt>
<dd><p>Logical specifying whether the rankings provided (or
generated from <code>preferences</code>) should be validated. Defaults to <code>TRUE</code>.
Turning off this check will reduce computing time with a large number of
items or assessors.</p></dd>


<dt id="arg-na-action">na_action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>Character specifying how to deal with <code>NA</code> values in the
<code>rankings</code> matrix, if provided. Defaults to <code>"augment"</code>, which means that
missing values are automatically filled in using the Bayesian data
augmentation scheme described in
Vitelli et al. (2018)
. The other options for this
argument are <code>"fail"</code>, which means that an error message is printed and the
algorithm stops if there are <code>NA</code>s in <code>rankings</code>, and <code>"omit"</code> which simply
deletes rows with <code>NA</code>s in them.</p></dd>


<dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>Optional computing cluster used for parallelization when generating
transitive closure based on preferences, returned from
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code>. Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-max-topological-sorts">max_topological_sorts<a class="anchor" aria-label="anchor" href="#arg-max-topological-sorts"></a></dt>
<dd><p>When preference data are provided, multiple
rankings will be consistent with the preferences stated by each users.
These rankings are the topological sorts of the directed acyclic graph
corresponding to the transitive closure of the preferences. This number
defaults to one, which means that the algorithm stops when it finds a
single initial ranking which is compatible with the rankings stated by the
user. By increasing this number, multiple rankings compatible with the
pairwise preferences will be generated, and one initial value will be
sampled from this set.</p></dd>


<dt id="arg-timepoint">timepoint<a class="anchor" aria-label="anchor" href="#arg-timepoint"></a></dt>
<dd><p>Integer vector specifying the timepoint. Defaults to <code>NULL</code>,
which means that a vector of ones, one for each observation, is generated.
Used by <code><a href="update_mallows.html">update_mallows()</a></code> to identify data with a given iteration of the
sequential Monte Carlo algorithm. If not <code>NULL</code>, must contain one integer
for each row in <code>rankings</code>.</p></dd>


<dt id="arg-n-items">n_items<a class="anchor" aria-label="anchor" href="#arg-n-items"></a></dt>
<dd><p>Integer specifying the number of items. Defaults to <code>NULL</code>,
which means that the number of items is inferred from <code>rankings</code> or from
<code>preferences</code>. Setting <code>n_items</code> manually can be useful with pairwise
preference data in the SMC algorithm, i.e., when <code>rankings</code> is <code>NULL</code> and
<code>preferences</code> is non-<code>NULL</code>, and contains a small number of pairwise
preferences for a subset of users and items.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"BayesMallowsData"</code>, to be provided in the <code>data</code>
argument to <code><a href="compute_mallows.html">compute_mallows()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Setting <code>max_topological_sorts</code> larger than 1 means that many possible
orderings of each assessor's preferences are generated, and one of them is
picked at random. This can be useful when experiencing convergence issues,
e.g., if the MCMC algorithm does not mix properly.</p>
<p>It is assumed that the items are labeled starting from 1. For example, if a
single comparison of the following form is provided, it is assumed that
there is a total of 30 items (<code>n_items=30</code>), and the initial ranking is a
permutation of these 30 items consistent with the preference 29&lt;30.</p>
<table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>29</td><td>30</td></tr></table><p>If in reality there are only two items, they should be relabeled to 1 and
2, as follows:</p>
<table class="table table"><tr><td><strong>assessor</strong></td><td><strong>bottom_item</strong></td><td><strong>top_item</strong></td></tr><tr><td>1</td><td>1</td><td>2</td></tr></table></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stein A (2023).
<em>Sequential Inference with the Mallows Model</em>.
Ph.D. thesis, Lancaster University.<br><br> Vitelli V, Sørensen, Crispino M, Arjas E, Frigessi A (2018).
“Probabilistic Preference Learning with the Mallows Rank Model.”
<em>Journal of Machine Learning Research</em>, <b>18</b>(1), 1–49.
<a href="https://jmlr.org/papers/v18/15-481.html" class="external-link">https://jmlr.org/papers/v18/15-481.html</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other preprocessing:
<code><a href="get_transitive_closure.html">get_transitive_closure</a>()</code>,
<code><a href="set_compute_options.html">set_compute_options</a>()</code>,
<code><a href="set_initial_values.html">set_initial_values</a>()</code>,
<code><a href="set_model_options.html">set_model_options</a>()</code>,
<code><a href="set_priors.html">set_priors</a>()</code>,
<code><a href="set_progress_report.html">set_progress_report</a>()</code>,
<code><a href="set_smc_options.html">set_smc_options</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Oystein Sorensen, Waldir Leoncio, Valeria Vitelli, Marta Crispino, Qinghua Liu, Cristina Mollica, Luca Tardella, Anja Stein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

