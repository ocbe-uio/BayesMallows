context("Testing that the random numbers are equal between platforms")

bmm <- compute_mallows_mixtures(
  n_clusters = c(1, 4),
  rankings = sushi_rankings, nmc = 50,
  save_clus = FALSE, include_wcd = FALSE, seed = 432
)

expect_equal(
  bmm[[2]]$cluster_probs$value[1:50],
  c(0.25, 0.25, 0.25, 0.25, 0.250115858981958, 0.245833894814954,
    0.24776442243802, 0.256285823765068, 0.251135941142119, 0.248741896990482,
    0.245346658898499, 0.254775502968901, 0.260010092279197, 0.246848656118417,
    0.242364459489917, 0.250776792112469, 0.286612380550491, 0.248877290112214,
    0.225511711385202, 0.238998617952094, 0.315813744568805, 0.240195321677621,
    0.212553537600346, 0.231437396153228, 0.344558808662294, 0.242678958084836,
    0.192191858980105, 0.220570374272766, 0.401658458239021, 0.23159315923816,
    0.164932083103286, 0.201816299419533, 0.444122764703085, 0.215880781314431,
    0.155157565237889, 0.184838888744595, 0.498466870746241, 0.199924173699993,
    0.133445808920573, 0.168163146633193, 0.53572562885119, 0.193524948556702,
    0.11385457872332, 0.156894843868789, 0.561632053524832, 0.189202817887636,
    0.109046860883147, 0.140118267704385, 0.573519662692584, 0.194172133651401
  )
)


m <- compute_mallows(sushi_rankings, n_clusters = 5, seed = 123, nmc = 20)

expect_equal(
  m$cluster_probs$value,
  c(0.2, 0.2, 0.2, 0.2, 0.2, 0.211429132832491, 0.187035286787252,
    0.199569648079635, 0.196576755493794, 0.205389176806829, 0.215974352168636,
    0.169267745861927, 0.200622955304601, 0.207433268008497, 0.206701678656338,
    0.203610460060645, 0.183965500338534, 0.185411901973881, 0.213128037980984,
    0.213884099645956, 0.184324827266658, 0.204697308643524, 0.15551989976882,
    0.234184148066541, 0.221273816254456, 0.191670130388175, 0.218988129339826,
    0.125058502777062, 0.245753153703819, 0.218530083791118, 0.16860761734979,
    0.253209894196243, 0.114730810410773, 0.249434659549669, 0.214017018493525,
    0.143562686725785, 0.313176054012709, 0.108214809198174, 0.239229099562144,
    0.195817350501188, 0.11882316779444, 0.366735125610565, 0.105476606061458,
    0.234100145639194, 0.174864954894344, 0.106623390313704, 0.420411761334555,
    0.101725778240084, 0.221857269981536, 0.14938180013012, 0.101038054089047,
    0.463290595797567, 0.0934432893330047, 0.204472837996669, 0.137755222783713,
    0.0875877375631389, 0.496149631227186, 0.0807824849956213, 0.205408856273011,
    0.130071289941043, 0.0717202123260116, 0.534163455004371, 0.084171812958948,
    0.193963591178636, 0.115980928532033, 0.0635340077408492, 0.571786845207142,
    0.0786490045482412, 0.18692864638149, 0.0991014961222779, 0.0604849613991433,
    0.592366157064124, 0.0681454106046093, 0.177352555620657, 0.101650915311467,
    0.0573612280439755, 0.625443970560007, 0.0528874525679085, 0.174931284112389,
    0.0893760647157194, 0.063899506192496, 0.631492643570718, 0.048716831124832,
    0.164135967861907, 0.0917550512500464, 0.0602463678331734, 0.644293346109443,
    0.0509147382506443, 0.164884351739573, 0.0796611960671665, 0.0649200072344718,
    0.659474660768512, 0.0516026187230967, 0.154812177535356, 0.0691905357385638,
    0.0611321904072824, 0.673491317118762, 0.0490338443037455, 0.145558289382426,
    0.0707843587877845)
)
